<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>

<head>
	<meta http-equiv="content-type" content="text/html;charset=ISO-8859-1">
	<title>Particle Boundary Conditions</title>
	<link rel="stylesheet" type="text/css" href="../help.css">
</head>

<body>

<p class="links">
<a href="../index.html">Home</a> &rarr;
<a href="index.html#contents">MPM XML File Contents</a>
</p>

<h1>Particle Boundary Conditions</h1>

<p>Several types of boundary conditions can be applied directly on the MPM particles. The possible boundary
conditions include loads, tractions, and concentration fluxes. Particle-based boundary conditions are typically applied
to particles on the boundary of the object.</p>

<p>All particle-based boundary conditions must be set up within a single <code>&lt;ParticleBCs&gt;</code> element.
The format is</p>

<pre>
&lt;ParticleBCs&gt;
   &lt;LdRect units='mm' xmin="18.5" xmax="20" ymin="-12" ymax="12"&gt;
      &lt;net/&gt;      
      &lt;LoadBC dir="1" style="1" load="400" time="0.0"/&gt;
      &lt;TractionBC dir="1" style="1" face="2" stress="400" time="0.0"/&gt; 
      &lt;ConcFluxBC dir="1" style="1" value="0" time="0.0"/&gt; 
   &lt;/LdRect&gt;
   
   &lt;LoadBCs&gt;
      &lt;load pt='398' dof='2' style='1'&gt;5e-05,0&lt;/load&gt;
      &lt;load pt='400' dof='2' style='1'&gt;5e-05,0&lt;/load&gt;
        ...
   &lt;/LoadBCs&gt;
&lt;/ParticleBCs&gt;
</pre>

<p>There are two ways to specify particle boundary conditions. The most common approach is
to <a href="#sec2">generate</a> conditions using one or more shape commands
(like <code>&lt;LdRect&gt;</code> above) to select particles and apply
specified <a href="#load">load</a> and/or <a href="#flux">concentration flux</a> boundary conditions
to all selected particles. The other way is to <a href="#sec1">explicitly</a> list each particle.
This method is shown in the <code>&lt;LoadBCs&gt;</code> section above, is limited to load conditions,
and is usually generated with other software. You can use a <code>&lt;LoadBCs&gt;</code> section along
with shape commands in the same input file. You can apply more than one condition to a particle and the
resulting boundary condition will be a superposition of the assigned conditions.
</p>

<a name="sec2"></a><h2>Generated Particle Boundary Conditions</h2>

<p>Particle boundary conditions are usually generated within one or more shape structures.
All particles defined by the shape will be assigned the selected boundary conditions subordinate to that element.
2D and 3D calculations use diffent shapes. The possible 2D shape commands are:</p>

<pre>
   &lt;LdRect xmin='18.5' xmax='20' ymin='-12' ymax='12'&gt;
      ...      
   &lt;/LdRect&gt;
      
   &lt;BCLine x1='0' y1="0" x2='100' y2='0' tolerance='0.1'&gt;
      ...
   &lt;/BCLine&gt;
   
   &lt;BCArc x1='0' y1='0' x2='100' y2='0' start='0' end='90' tolerance='0.1'&gt;
      ...
   &lt;/BCArc&gt;
</pre>
   
<p>The possible 3D shape commands are:</p>

<pre>
   &lt;BCBox xmin='18.5' xmax='20' ymin='-12' ymax='12' zmin='0' zmax='10' axis='0'&gt;
      ...      
   &lt;/BCBox&gt;
</pre>

   
<p>where</p>

<dl>

<dt>xmin, xmax, ymin, ymax, zmin, zmax</dt>
<dd>These attributes define the extent of a rectangle (2D) or box (3D) (they can be entered with numeric values or <a href="dispbc.html#minmax">relative to the mesh edges</a>). An optional <code>axis</code> attribute for <code>BCBox</code> can convert the shape to the cylinder enclosed within the box with axis along the specified direction (as x, 1, y, 2, z, or 3).
An optional <a href="mpmheader.html#units"><code>units</code> attribute</a> can specify the length units.
All material points that fall within the rectangle or box or cylinder will be assigned the boundary conditions of the
subordinate elements. For axisymmetric MPM, <code>x</code> and <code>y</code> refer to <code>R</code> and <code>Z</code> directions.</dd>

<dt>(x1,y1) to (x2,y2)</dt>
<dd>These attributes define the end points of a line (in <code>BCLine</code>) or corner points of an
oval (in <code>BCArc</code>) (they can be entered with numeric values or <a href="dispbc.html#minmax">relative to the mesh edges</a>).
An optional <a href="mpmheader.html#units"><code>units</code> attribute</a> can specify the length units).
All material points that fall within <code>tolerance</code> of the line (for <code>BCLine</code>) or
the arc (for <code>BCArc</code>) will be assigned the boundary conditions of the subordinate elements.
The arc will trace the oval defined by the points over angles from <code>start</code> to <code>end</code> in
the counter-clockwise direction where <code>start=0</code> is along the <code>x</code> axis.  For axisymmetric MPM, <code>x</code> and <code>y</code> refer to <code>R</code> and <code>Z</code> directions.</dd>

<dt>start, end</dt>
<dd>The start and end angles (in degrees) for <code>BCArc</code> shapes. The arc is traced in the
counter-clockwise direction with angle = 0 being along the <code>x</code> axis.</dd>

<dt>tolerance</dt>
<dd>This number defines the maximum distance from the line to the particle for that material
point to be assigned boundary conditions (an optional <a href="mpmheader.html#units"><code>units</code> attribute</a>
can specify the length units). You can optionally use the format <code>'*0.5'</code> to set
the tolerance to any factor <i>times</i> the minimum cell dimension in the current mesh.
</dd>

</dl>

<p>The elements subordinate to the shape commands can assign <a href="#load">load</a> and/or <a href="#flux">concentration
flux</a> boundary conditions. Any combination of types of boundary conditions can be used within a single shape.
</p>

<a name="load"></a><h2>Generated Particle Load or Traction Conditions</h2>

<p>Particle load or traction conditions subordinate to shape elements are created using:
</p>

<pre>
   &lt;LoadBC dir='1' style='1' load='400' time='0.0' function='x*t'/&gt; 
</pre>

<pre>
   &lt;TractionBC dir='1' style='1' face='1' stress='400' time='0.0' function='x*t'/&gt; 
</pre>

<p>where</p>

<dl>

<dt>dir</dt>
<dd>Defines the loading direction (<code>1</code> for <code>x</code> axis, <code>2</code> for <code>y</code> axis,
<code>3</code> for <code>z</code> axis (if 3D), <code>1</code> for <code>R</code> axis (if axisymemtric), or <code>2</code> for <code>Z</code> axis (if axisymemtric)). For <code>TractionBC</code>, <code>dir</code> can be 11 or 12 to mean normal or shear traction relative the the selected <code>face</code>, respectively. A normal traction is positive if pointing out of the particle domain and a shear traction is positive when oriented in the counter-clockwise direction. Normal and shear tractions are not allowed in 3D calculations.</dd>

<dt>style</dt>
<dd>Defines the type of loading (<a href="#style">see below</a>).</dd>

<dt>face (for <code>TractionBC</code>)</dt>
<dd>The face of the original particle domain that is loaded by traction. In 2D, the faces are the edges numbered 1 through 4 in the counter-clockwise direction with the bottom edge being number 1. In 3D, 1 to 4 are the same faces (<i>i.e.</i>, faces with normals (0,-1,0), (1,0,0), (0,1,0), and (-1,0,0) on the original particle domain, respectively), 5 is the bottom (with normal (0,0,-1)), and 6 is the top (with normal (0,0,1)).</dd>

<dt>load and time (for <code>LoadBC</code>)</dt>
<dd>Defines the two parameters (<code>value</code> and <code>time</code>) for the specified style
(<a href="#style">see below</a>). The load parameter is in Newtons or N/ms.</dd>

<dt>stress and time (for <code>TractionBC</code>)</dt>
<dd>Defines the two parameters (<code>value</code> and <code>time</code>) for the specified style
(<a href="#style">see below</a>). The stress parameter is in MPa or MPa/ms.</dd>

<dt>function</dt>
<dd>When using <a href="#function"><code>style=6</code></a>, enter an arbitrary <a href="function.html">user-defined
function</a> of time (<code>t</code> in ms), of current particle position (<code>x</code>, <code>y</code>, <code>z</code>, <code>D</code>, <code>T</code>, <code>R</code>, and <code>Z</code>).
in mm), and/or of current clockwise particle rotation angle (<code>q</code> in radians).
The function should evaluate to load in Newtons (for <code>LoadBC</code>) or stress in MPa (for <code>TractionBC</code>). When using a function, the <code>load</code> and <code>stress</code> attributes
are ignored, but <code>time</code> can be used to determine <a href="#function">when the function is evaluated</a>.</dd>

</dl>

<h3>LoadBC options</h3>

<p>By default, the <code>load</code> argument (in N or N/ms) or the load (in N) returned by a function
give the load on each particle with that boundary condition. Alternatively, a load or function
can evaluate to the total Newtons applied to all particles in the <a href="#sec2">current shape</a>.
To enter total load, include a <code>&lt;net/&gt;</code> command within the <a href="#sec2">shape command</a>
containing the <code>LoadBC</code> command before the <code>LoadBC</code> command. To specify load per particle,
include <code>&lt;perParticle/&gt;</code> (or have no command since per particle is the default setting).
You can switch back and forth between total load and per-particle load in a single shape by using mutliple
<code>&lt;net/&gt;</code> and <code>&lt;perParticle/&gt;</code> commands. These commands only apply to particle
load boundary conditions and have no effect on other boundary conditions, including <code>TractionBC</code> conditions, within the same
<a href="#sec2">shape command</a>.</p>

<h3>TractionBC requirements</h3>

<p>To calculate forces from specified traction stresses, the simulation needs to know the <a href="definemesh.html">grid thickness</a> and it should match the particle thickness. The use of tractions also requires <a href="mpmheader.html#gimp">uGIMP or lCPDI anlaysis metho</a>.
</p>

<h3>Difference Between LoadBC and TractionBC</h3>

<p>The <code>LoadBC</code> option considers the load (in N) to be applied directly to the particle, which in MPM is not really applied to the surface of the body, even when the particle is on the edge. During the MPM algorithm, this load is extrapolated to all nodes around the paraticle resulting in some of a modeled loading being applied internal to the object. It is common, therefore, to see artifacts in particles near edges that are loaded directly by forces. The MPM results away from the particles, however, seem to be correct. This form of external loading appears to be common to all MPM codes.</p>

<p>In contrast, the <code>TractionBC</code> option attempts to apply the load (as a stress) on the actual surface by implementing a surface integral term that appears in MPM derivations. This integral involves integration of the traction times grid shape functions on the particle surface. This surface is found  from the current particle deformation, which depending on the current <a href="mpmheader.html#gimp">MPM method</a> being used, ad follows:</p>
  <ul class="lev2args">
  <li><code>Dirac</code>: <code>TractionBC</code> commands are not allowed in this method; only <code>LoadBC</code> can be used</li>
  <li><code>uGIMP</code>: Integrate on the surface determined from the initial particle shape but translated to the new particle position.</li>
  <li><code>lCPDI</code> or <code>qCPDI</code>: Find parallelogram (2D) or parallelopiped (3D) for the deformed particle domain from the particle's deformation gradient and integrate the selected surface terms by expanding its integrand in linear shape functions (<i>i.e.</i>, very similar to <code>CPDI</code> methods for shape function integration).</li>
  </ul>
<p>This method appears to reduce artifacts that occur on particles loaded by <code>LoadBC</code>. Because this method applies forces closer to the actual edge, the potential for artifacts due to low-mass nodes is a concern. The code tries to screen out obvious problem nodes. If instability occurs, try <code>LoadBC</code> instead. The current <code>TractionBC</code> implementation ignores <a href="cracks.html">cracks</a>. They can be used in probems with cracks, but only if the tractions are all at least two grid elements away from any crack plane.</p>

<p>Another difference is that <code>LoadBC</code> applies a total force. In large deformation problems, the stress will change if the cross-section area changes. In contrast, <code>TractionBC</code> applies a stress to the deformed particle domain, which means its effect depends on <a href="mpmheader.html#gimp">MPM method</a> being used. When using <code>uGIMP</code>, the deformed particle domain is the same as the initial particle domain and therefore the applied stress will always be engineering stress based on initial particle area (<i>i.e.</i>, the stress will change if particle cross-sectional area changes). But, when using <code>lCPDI</code> or <code>qCPDI</code>, the stress will be a true stress that remains constant even if the particle cross sectional area changes.</p>

<a name="style"></a><h2>Boundary Condition Styles</h2>

<p>The <code>value</code>, <code>style</code>, and <code>time</code> attributes for particle-based boundary conditions are used to set the time-dependence of the boundary conditions. The <code>style</code> options are listed below and any number of options can be combined on a single particle. When a single particle has multiple conditions, the resulting condition will be a superposition of the imposed conditions.</p>

<dl>
  <dt>Style=1 (constant)</dt>
  <dd>Set condition to <code>(value)</code> starting at time in <code>(time)</code> attribute. The units for <code>(time)</code> are ms.</dd>
  
  <dt>Style=2 (linearly increasing condition)</dt>
  <dd>Set condition to <code>(value)*[t-(time)]</code> where <code>t</code> is current time (in ms) and and <code>(time)</code> has units ms.</dd>

  <dt>Style=3 (sine variation)</dt>
  <dd>Set condition to <code>(value)*sin[t*(time)]</code> where <code>t</code> is current time (in ms) and <code>(time)</code> has units 1/ms.</dd>
  
  <dt>Style=4 (cosine variation)</dt>
  <dd>Set condition to <code>(value)*cos[t*(time)]</code> where <code>t</code> is current time (in ms) and <code>(time)</code> has units 1/ms.</dd>
  
  <dt>Style=5 (silent boundary)</dt>
  <dd>Set the boundary to absorbing boundary conditions. The intent of a silent boundary is to eliminate reflected waves at a free edge and mimic a sample in a semi-infinite domain. The silent boundary must have normal vector in <code>x</code> or <code>y</code> direction (or in <code>R</code> or <code>Z</code> direction for axisymmetric MPM). The <code>dir</code> attribute specifies the direction of the normal vector. There is no need to specify a <code>load</code> or <code>time</code> argument. This boundary condition currently only works for linear elastic, isotropic materials and it requires a regular grid. Silent boundary conditions are only allowed for particle loads. See <a href="references.html#Shen2005">Shen and Chen</a> for details on their development.
  </dd>
  
  <dt><a name="function"></a>Style=6 (user-defined function)</dt>
  <dd>Set condition to the evaluated value of a <a href="function.html">user-defined function</a> of time (<code>t</code> in ms), of current particle position (<code>x</code>, <code>y</code>, <code>z</code>, <code>D</code>, <code>T</code>, <code>R</code>, and <code>Z</code> in mm), and/or of current clockwise particle rotation angle (<code>q</code> in radians). If the <code>time</code> attribute is used the condition starts at time in the <code>(time)</code> attribute and the function is evaluated at <code>(t-(time))</code> (in ms). A function of rotational angle is sometimes needed for large displacement calculations.</dd>
</dl>

<a name="flux"></a><h2>Generated Concentration Flux Conditions</h2>

<p>When doing diffusion calculations, you can set surface flux boundary conditions on particles (which are expected to be particles near the surface). Any surface particles with no boundary conditions will implement zero-flux boundary conditions; there is no use in setting zero flux conditions There are three-options for setting non-zero flux conditions:
</p>

<h3>Externally Applied Flux</h3>

<p>To apply an external flux, use:
</p>

<pre>
    &lt;ConcFluxBC dir='1' face='1' style='1' value='0' time='0.0' function='sinh(t)'/&gt; 
</pre>


<p>where</p>

<dl>

<dt>dir</dt>
<dd>Must be 1 to indicate an external flux.</dd>

<dt><a name="fluxface"></a>face</dt>
<dd>The face of the original particle domain that in on the boundary and has the concentration flux. In 2D, the faces are the edges numbered 1 through 4 in the counter-clockwise direction with the bottom edge being number 1. In 3D, 1 to 4 are the same faces (<i>i.e.</i>, faces with normals (0,-1,0), (1,0,0), (0,1,0), and (-1,0,0) on the original particle domain, respectively), 5 is the bottom (with normal (0,0,-1)), and 6 is the top (with normal (0,0,1)).</dd>

<dt>style</dt>
<dd>Defines the type of flux using <a href="#style">standard styles</a>. <a href="#silentflux">See below</a> for meaning of the <code>silent</code>.</dd>

<dt>value and time</dt>
<dd>These arguments are used with the chosen <a href="#style">style</a>. The resulting external flux should be in kg/(m^2-sec). Positive flux is to into the object and negative is out of the object. For isotropic material with applied flux <code>J</code>, the expected output concentration gradient is <code>dc/dn = J/(&rho; D)</code>, where <code>n</code> is coordinate normal to the surface. The resulting <code>dc/dn</code> may differ however, if concentration on the edge with defined flux approaches the saturation concentration.</dd>

<dt>function</dt>
<dd>When using <a href="#style"><code>style=6</code></a>, enter an arbitrary <a href="function.html">user-defined function</a> of time (<code>t</code> in ms), of current particle position (<code>x</code>, <code>y</code>, <code>z</code>, <code>D</code>, <code>T</code>, <code>R</code>, and <code>Z</code> in mm), and/or of current clockwise particle rotation angle (<code>q</code> in radians). The function should evaluate to the flux in kg/(m^2-sec). When using a function, the <code>value</code> attribute is ignored, but <code>time</code> can be used to determine <a href="#function">when the function is evaluated</a>.
</dd>


</dl>


<h3>Coupled Surface Flux</h3>

<p>This option sets the surface flux to some function of the difference between the particle concentration potential and the concentration potential of a surrounding reservoir:
</p>

<pre>
    &lt;ConcFluxBC dir='2' face='3' style='6' function='t^2'  bath='1'/&gt; 
</pre>


<p>where</p>

<dl>

<dt>dir</dt>
<dd>Must be 2 to indicate a coupled surface flux.</dd>

<dt>face</dt>
<dd>The face with the flux as defined <a href="#fluxface">above</a>.</dd>

<dt>style</dt>
<dd>Must be 6 meaning the condition is specified in a function (see below)</dd>

<dt>function</dt>
<dd>Enter an arbitrary <a href="function.html">user-defined function</a> of <code>t</code>, where <code>t</code> stands for the difference between the particle concentration potential and the reservoir concentration potential, of current particle position (<code>x</code>, <code>y</code>, <code>z</code>, <code>D</code>, <code>T</code>, <code>R</code>, and <code>Z</code> in mm), and/or of current clockwise particle rotation angle (<code>q</code> in radians). The function should evaluate to the flux in kg/(m^2-sec). The sign is irrelevant. The applied flux will be positive if the particle concentration is less than the bath or negative if it is greater than the bath. The magnitude of the function gives the magnitude of the flux.
</dd>

<dt>bath</dt>
<dd>The concentration potential (0 to 1) of the surrounding reservoir bath. Note that the bath is specified as a concentration potential (c/csat) and not actual weight fraction concentation.</dd>

</dl>


<h3><a name="silentflux"></a>Silent Surface Flux</h3>

<p>This option sets the surface flux to the natural flux determined by <code>(D grad c).n</code> on particles on the edge with the boundary condition. It should enable simulation of flux through materials. 
</p>

<pre>
    &lt;ConcFluxBC dir='1' face='2' style='5'/&gt; 
</pre>


<p>where</p>

<dl>

<dt>dir</dt>
<dd>Must be 1.</dd>

<dt>face</dt>
<dd>The face with the flux as defined <a href="#fluxface">above</a>.</dd>

<dt>style</dt>
<dd>Must be 5 meaning the condition is a silent boundary condition</dd>

</dl>


<a name="sec1"></a><h2>Explicit Particle Loading</h2>

<p>Explicit particle loads are defined with <code>&lt;load&gt;</code> elements within a <code>&lt;LoadBCs&gt;</code> element. The <code>pt</code> attribute determines which particle has the specified load. Because this command requires knowledge of the particle numbering, it is usually used in combination with the <a href="definempm.html"><code>&lt;PointList&gt;</code></a> method to define particles. The format for a <code>&lt;load&gt;</code> command is:
</p>

<pre>
   &lt;load pt='398' dof='2' style='1'&gt;5e-05,0&lt;/load&gt;
</pre>

<p>where</p>

<dl>
<dt>Text of the Element</dt>
<dd>The data in the element has two
numbers whose meanings are the <code>value</code> and <code>time</code> arguments for the boundary condition <a href="#style">styles</a> listed below. The <code>value</code> is in Newtons. When using an arbitrary function (see <code>Style=6</code> below) the data in the element should be the a <a href="function.html">user-defined function</a> of <code>t</code> (in ms) that evaluates to load in Newtons.</dd>

<dt>dof</dt>
<dd>Determines if applied load is in the <code>x</code> direction (<code>dof=1</code>), the <code>y</code> direction (<code>dof=2</code>), <code>z</code> direction (<code>dof=3</code>, 3D only), <code>R</code> direction (<code>dof=1</code>, if axisymnmetric), or <code>Z</code> direction (<code>dof=2</code>, if axisymmetric). To apply load in arbitrary direction, use a combination loads in the different directions.</dd>

<dt>style</dt>
<dd>Determines the time dependence of the boundary condition. The possible styles are defined <a href="#style">above</a>. If this attribute is omitted, it is assumed to be 1.
</dd>

</dl>


<p class="links">
<a href="../index.html">Home</a> &rarr;
<a href="index.html#contents">MPM XML File Contents</a>
</p>

</body>

</html>