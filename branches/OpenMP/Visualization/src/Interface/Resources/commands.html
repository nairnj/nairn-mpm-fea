<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html;charset=ISO-8859-1">
	<title>NairnFEAMPMViz Help</title>
<style type="text/css">
h1 { font-family: Arial, "Lucida Grande", Helvetica, Swiss, Geneva, SunSans-Regular;
	font-size: 16pt;
	background-color: #CCCCCC;
	font-weight: bold;
	padding: 6pt; }
h2 { font-family: Arial, "Lucida Grande", Helvetica, Swiss, Geneva, SunSans-Regular;
	font-size: 14pt;
	margin-left: 3pt;
	background-color: #CCCCCC; }
h3 { font-family: Arial, "Lucida Grande", Helvetica, Swiss, Geneva, SunSans-Regular;
	font-size: 12pt;
	margin-left: 3pt;
	color: #005500;}
p { font-family: Arial, "Lucida Grande", Helvetica, Swiss, Geneva, SunSans-Regular;
	font-size: 12pt;
	margin-top: 0pt;
	margin-left: 12pt;
	margin-bottom: 6pt; }
ul { font-family: Arial, "Lucida Grande", Helvetica, Swiss, Geneva, SunSans-Regular;
	font-size: 12pt;
	list-style-image: Bullet.png;
	margin-top: 0pt;
	margin-bottom: 0pt;
	margin-left: 28pt; }
ul li { margin-top: 0pt;
	margin-bottom: 3pt; }
ol { font-family: Arial, "Lucida Grande", Helvetica, Swiss, Geneva, SunSans-Regular;
	font-size: 12pt;
	margin-left: 28pt;
	margin-top: 0px;
	margin-bottom: 0px; }
ol li { margin-top: 0px;
	margin-bottom: 3pt; }
img { vertical-align: middle; }
hr { margin-top: 0pt;
	margin-left: 0pt;
	margin-right: 6pt;
	padding: 0pt; }
code { font-size: 12pt;
	   background-color: #FFFFBB;}
blockquote { font-size: 12pt;
       font-family: Courier; }
	
</style>
</head>

<body>

<div id="pagetitle"><h1>NairnFEAMPMViz Commands Language</h1></div>

<p><b>NairnFEAMPMViz</b> has a built-in <a href="#language">interpretive language</a> for programatically setting up FEA or MPM calculations. This section has a list of all language commands for FEA and MPM calculations. The commands are grouped by logical section. Within each section, they are listed alphabetically. Some commands apply to more than one section and thus may appear in several sections.
</p>

<p>This &quot;scripting&quot; option for NairnFEAMPMViz is new in version 4.0 and is not yet complete. The scripting <a href="#language">language</a> is based on (and nearly <a href="#compatible">compatible</a>) with the corresponding language in the NairnFEAMPM Mac application. The documentaiton listed below lists all the commands from NairnFEAMPM. The ones that are highlighted in yellow are the ones that been converted to work in NairnFEAMPMViz. The others will be added during development. The conversion is nearly completed for FEA calculations. If used for MPM calculations, many parts of the commands will will need to use the <a href="#xmldata">XMLData command</a> to enter commands not yet supported in the scripting language. Furthermore, a few language features (<i>e.g.</i>, repeat loops and subroutines) are not yet available. See the <a href="#language">language reference</a> section for what is available.</p>

<h2>Command Groupings</h2>

<p>The command groupings are:</p>

<ul>
<li><a href="#language">Language Reference</a></li>
<li><a href="#header">Main Analysis Header</a> commands</li>
<li><a href="#mpmheader">MPM Analysis Header</a> commands</li>
<li><a href="#materials">Defining Materials</a> commands</li>
<li><a href="#grid">Defining the MPM Grid and Material Points</a> commands</li>
<li><a href="#feamesh">Defining the FEA Mesh</a> commands</li>
<li><a href="#cracks">Explicit Crack</a> commands</li>
<li><a href="#mmmode">Multimaterial MPM</a> commands</li>
<li><a href="#thermal">Thermal Calculation</a> commands</li>
<li><a href="#conc">Concentration Calculation</a> commands</li>
<li><a href="#bconds">Boundary Condition</a> commands</li>
<li><a href="#custom">Custom Task</a> commands</li>
<li><a href="#xml">XML Insertion</a> commands</li>
<li><a href="#function">User-Defined Functions</a></li>
</ul>

<h2><a name="language"></a>Language Reference</h2>

<h3>Line Syntax</h3>

<p>Each line of the commands to set up FEA or MPM models has the format:</p>
<blockquote>
Command #1,#2,#3,#4,...
</blockquote>
<p>where Command is the command and #1, #2, etc., are arguments to the command. The command
must be separated from the arguments by a space. The arguments must be separated by commas.
Leading and trailing spaces in arguments are ignored. Blank lines are ignored.
Lines whose first non-blank character is &quot;!&quot; are comments and are also ignored.
</p>

<p>Any argument to any command can be a number, a string, a numeric expression, or a
string expression (see next section).</p>

<h3>Variables and Expressions</h3>

<p>The commands can define numeric and string variables. Numeric variable names must begins
in a letter or #, contain only letters and numbers or underscores, and have no
function name as a substring within the name. String variable are the same except they must
end in $. You create variables using the Set command:</p>
<blockquote>
Set var = expression
</blockquote>
<p>where &quot;expression&quot; is any basic mathematical expression for numeric variables
or a string expression for string variables. The &quot;Set&quot; command is
optional (<i>i.e.</i>, any line with variable name followed by equals sign is assumed
to be a &quot;Set&quot; command.</p>

<p>Numeric expressions use standard operators (+, 0, *, /, ^, and %) and standard precedences
unless grouped by parentheses. The expression can use the math
functions cos(), sin(), tan(), acos(), asin(), atan(), cosh(), sinh(), tanh(), sqrt(),
log(), log10(), exp(), abs() int(), sign(), and rand(). String expressions can
combine quoted strings and variables with the single operator &amp;. Nummeric variables
can be used and they are converted to strings. You cannot embed numeric expressions
within string expressions.</p>


<h3>Conditionals</h3>

<p>Conditional blocks have the format:</p>
<blockquote>
if expr1 == expr2<br>
   &nbsp;&nbsp;...<br>
else ifStr expr3 &lt; expr4<br>
   &nbsp;&nbsp;...<br>
else ifDef var1<br>
   &nbsp;&nbsp;...<br>
else ifNDef var2<br>
   &nbsp;&nbsp;...<br>
else<br>
   &nbsp;&nbsp;...<br>
endif
</blockquote>
<p>In the standard if, the expressions are compared by numeric comparison, unless one or
both are strings, in which case string comparison is used. The ifStr command forces string
comparison between the expressions. The comparison operaters
are =, ==, &quot;is&quot;, !=, &gt;, &gt;=, &lt;, and &lt;=. For numbers, =, ==, and &quot;is&quot; are
the same. For strings, = and &quot;is&quot; are case insensitive comparisons
and == is case sensitive. An ifDef comparison is true if the variable name
given has been defined in at least one Set command. The ifNDef comparison is true if the variable
has not been defined in any Set command.</p>

<h3>Repeat Loops</h3>

<p>To be developed.</p>

<h3>Subroutines</h3>

<p>To be developed.</p>

<h3>Debugging Commands</h3>

The following commands are not used to generate input command files, but can be useful in debugging scripts:

<ul>
<li><code>Write #1,#2,...</code><br>
Write each argument (string or number or expression) to the output console.
</li>
<li><code>Stop #1,#2,...</code><br>
Write each argument (string or number or expression) to
the output console and then stop the calculations.
</li>
<li><code>Clear</code><br>
Clear all text from the output console.
</li>
</ul>

<h3><a name="campatible"></a>Comparison to NairnFEAMPM Language</h3>

<p>The scripting language in NairnFEAMPMViz is based on the corresponding scripting commands in the Mac application NairnFEAMPM. The key difference are:</p>
<ol>
<li>String variables are required to end in a $, while in NairnFEAMPM, that is not required, but is allowed.</li>
<li>The main command on each line must be separeted from arguments by a space and arguments must be delimited by commands. In NairnFEAMPM commands and arguments can be delimited by commas, spaces, or tabs.</li>
<li>Variables can begin in a letter or a #. In NairnFEAMPM, they <i>must</i> all begin in #.</li>
<li>String expression can only combine quoted text and variables with the &amp; operator. In NairnFEAMPM, numeric expression can be embedded in string expressions by grouping them in parentheses, but that is not allowed in NairnFEAMPMViz.</li>
<li>Array variables (using [] after the variable name) is not yet developed for NairnFEAMPMViz.</li>
</ol>
<p>When writing command files to use in both applications, you should avoid anything not supported in both applications. The key recommendations are to start all variables in #, to end string variables in $, and to use string expressions allowed in NairnFEAMPMViz.</p>


<h2><a name="header"></a>Main Analysis Header</h2>

<p>These commands define the type of analysis (FEA or MPM) and enter comments about the calculations.</p>

<ul>
<li><code>Analysis #1</code><br>
Define type of analysis to be done. #1 can be &quot;Plane Strain FEA&quot; (or 0), &quot;Plain Stress FEA&quot; (or 1), &quot;Axisymmetric FEA&quot; (or 2), &quot;Plane Strain MPM&quot; (or 10), &quot;Plain Stress FEA&quot; (or 11), &quot;Axisymmetric MPM&quot; (or 12), or &quot;3D MPM&quot;.</li>
<li><code>Comment #1,&lt;#2:gt;,&lt;#3:gt;,&lt;#4:gt;...</code><br>
Add a comment to the analysis description by evaluating each command and appending to a line beginning in &quot;Comment:&quot;.</li>
<li><code>Header<br>&nbsp;&nbsp;(lines of text)<br>EndHeader</code><br>
Enter an analysis description on multiple lines of text.</li>
<li><code>Name #1</code><br>
Defines name of the person doing the analysis.</li>
<li><a name="output"></a><code>Output #1,#2,&lt;#3&gt;,&lt;#4&gt;,...</code><br>
Select the desired output results for FEA calculations. The arugments appear in pairs. The first of each pair can be &quot;displacements&quot;, &quot;forces&quot;, &quot;elementstresses&quot;, &quot;nodalstresses&quot;, &quot;reactivities&quot;, or &quot;energy&quot; to include those results in output FEA results file. The second of each pair can be &quot;yes&quot; or &quot;no&quot; to include or omit those results, or it can be &quot;selected&quot; to only include results for selected nodes and elements (see <a href="#select">Select</a>, <a href="#selectline">SelectLine</a>, and <a href="#selectpoint">SelectPoint</a> comands).</li>

<li><code>Processors #1</code><br>
Select number of processors (1 or more) for running parallel code (requires parallel versions
of the code engines).</li>
<li><code>Title #1</code><br>
Defines a title for the analysis.</li>
</ul>

<h2><a name="mpmheader"></a>MPM Analysis Header</h2>

<p>These commands define many features of MPM calculations such as archiving options and other global MPM settings.</p>

<ul>
<li><code>Archive #1</code><br>
Select archiving folder for MPM calculations as relative path from the output file.</li>
<li><code>ArchiveUnique #1</code><br>
Same as Archive command excepts creates unique subfolder to prevent overwriting of previous results.</li>
<li><code>ArchiveTime #1,&lt;#2&gt;</code><br>
Select archiving frequency for MPM calculations. #1 is the archiving time in ms. The option #2 is the time to start archiving (in ms).</li>
<li><code>Damping #1</code><br>
Select factor for damping grid velocities in MPM calculations. #1 is factor or is a
<a href="#function">user-defined function</a>.
Both in units of 1/sec.</li>
<li><code>FeedbackDamping #1,&lt;#2:gt;,&lt#3:gt;</code><br>
Select coefficient for alternative viscous damping of MPM particle velocities. #1 is feedback coefficient
in units of 1/mm<sup>2</sup>. Option #2 is target kinetic energy (it can be
<a href="#function">user-defined function</a>) in micro joules. Optional
#3 is maximum damping factor in units 1/sec (default is to have no maximum).
</li>
<li><code>GlobalArchive #1,&lt;#2&gt;</code><br>
Specify global result to be archived in #1. If #2 is provided and can material ID
to archive this result only for particles of that material.</li>
<li><code>GlobalArchiveTime #1</code><br>
Specify time interval for archiving global results. #1 is the glboal archiving time in ms.</li>
<li><code>LeaveLimit #1</code><br>
Set number of particles allowed to leave the grid (#1) before an analysis is stop.
If command is omitted, the limit is 1% of the particles.</li>
<li><a name="maximumtime"></a><code>MaximumTime #1</code><br>
Set time the MPM calculations will stop in ms.</li>
<li><code>MPMMethod #1,#2</code><br>
Select MPM methods for the calculations. #1 is the update method and it can be USF (or 0), USAVG (or 2) or SZS (or 3). #2 is the shape functions method and it can be uGIMP (or GIMP), lCPDI (or CPDI), qCPDI, or Classic (or Dirac).</li>
<li><code>PtsPerElement #1</code>
Select number of material points per element (#1) in MPM calculations. The default is 4 for 2D and 
8 for 3D.</li>
<li><code>TimeStep #1,&lt;#2&gt;,&lt;#3&gt;</code><br>
Set MPM time step parameters. #1 is the time step in ms (choose a high number to have the code pick time step based on material properties). Optional #2 is the maximum time to stop the calculations in ms (which can also be set in the <a href="#maximumtime">Maximum time command</a>). Optional #3 is the Courant-Levy safety factor for the code to adjust the time step (and should be less than 1).</li>
<li><code>ToArchive #1,&lt;#2&gt;,...</code><br>
Specify results to be archived in MPM calculations. The list can be in multiple arguments
and/or in multiple ToArchive commands. The archiving options are velocity,
stress, strain, plasticstrain, workenergy, temperature, plasticenergy,
shearcomponents, strainenergy, jintegral, stressintensity, history1,
history2, history3, history4, heatenergy, concentration
(which includes concentration gradients), energybalance, elementcrossings, and rotstrain.</li>
</ul>

<h2><a name="materials"></a>Defining Materials</h2>

<p>The details on the one command in this section explain how to enter properties for materials used in the calculations.</p>

<ul>
	<li><a name="material"></a><code>Material #1,#2,#3<br>
	&nbsp;&nbsp;(commands to define properties)<br>
	Done</code><br>
	Define a material type or traction law. For more details see the materials help topic.</li>
</ul>

<h2><a name="grid"></a>Defining the MPM Grid with Material Points</h2>

<p>These commands are used to define the background MPM grid and to define material points within that grid.</p>

<ul>
<li><a name="bmpregion"></a>BMPRegion ... EndRegion: Create material points from an image in a BMP file.</li>

<li><code>Box #1,#2,#3,#4,#5,#6</code><br>
Define cubical volume using xmin, xmax, ymin, ymax, zmin, and zmax (for #1 to #6) for the current
<a href="#regionmpm">region</a> or <a href="#holempm">hole</a> block.</li>

<li>Cylinder: Define cylindrical volume of material points or for a hole.</li>

<li><code>Element #1</code><br>
Define type of element to use in the MPM background grid. Currently #1 can only be &quot;4 Node Quadrilateral&quot; (or 2) for 2D or axisymmetric MPM and can only be &quot;8 Node Brick&quot; (or 7) for 3D MPM.</li>

<li>Intensity: Map pixel intensities to material types in a <a href="#bmpregion">BMPRegion</a>.</li>

<li><a name="griddepth"></a><code>GridDepth #1,&lt;#2&gt;</code><br>
Set depth or z-direction MPM grid parameters. #1 is the number of cells. #2 is for variable element size, but is currently ignored.</li>

<li><a name="griddhoriz"></a><code>GridHoriz #1,&lt;#2&gt;</code><br>
Set horizontal or x-direction MPM grid parameters (r direction is axisymetric). #1 is the number of cells. #2 is for variable element size, but is currently ignored.</li>

<li><code>GridRect #1,#2,#3,#4,&lt;#5&gt;,&lt;#6&gt;</code><br>
Set rectangle for 2D MPM grid or box for 3D MPM. #1 to #4 are x minimum. x maximum, y minimum,
and y maximum for the rectangle (or R and Z limits if axisymmetric). #5 and #5 are for z minimum
and z maximum if 3D calculations. Use <a href="#gridhoriz">GridHoriz</a>,
<a href="#gridvert">GridVert</a>, and <a href="#griddepth">GridDepth</a> to set number of
cells in each direction.</li>

<li><code>GridThickness #1</code><br>
Set thickness for 2D MPM grid (in mm). It is only needed for some command and for 2D planar calculations.</li>

<li><a name="gridvert"></a><code>GridVert #1,&lt;#2&gt;</code><br>
Set vertical or y-direction MPM grid parameters (Z direction is axisymetric).
#1 is the number of cells. #2 is for variable element size, but is currently ignored.</li>

<li><a name="holempm"></a><code>Hole<br>
&nbsp;&nbsp;(series of <a href="#rectmpm">Rect</a>, <a href="ovalmpm">Oval</a>, or <a href="#polyptmpm">PolyPt</a> commands)<br>
EndHole</code><br>
Define a region for creating a hole that will not be assigned material points by any
subsequent shape commands.</li>

<li><a name="originmpm"></a>Origin: Set origin to map data in <a href="#bmpregion">BMPRegion</a> to
the grid.</li>

<li><a name="ovalmpm"></a><code>Oval #1,#2,#3,#4</code><br>
Define oval within the rectangle defined by xmin, xmax, ymin, ymax (for #1 to #4) for the
current <a href="#regionmpm">region</a> or <a href="#holempm">hole</a> block.</li>

<li><a name="polyptmpm"></a><code>PolyPt &lt;#1:&gt;,&lt;#2&gt;</code><br>
Define next point on a polygon shape or if no paramters, close the current polygon shape.
If a polygon is open and the end of a <a href="#regionmpm">region</a> or <a href="#holempm">hole</a> block, it is automatically closed.</li>

<li><a name="rectmpm"></a><code>Rect #1,#2,#3,#4</code><br>
Define rectangle using xmin, xmax, ymin, ymax (for #1 to #4) for the current
<a href="#regionmpm">region</a> or <a href="#holempm">hole</a> block.</li>

<li><a name="regionmpm"></a><code>Region #1,#2,#3,#4,(#5,#6)<br>
    ...<br>
EndRegion</code><br>
Define a region for creating material points. #1 is material ID. (#2,#3) are velocities in x and y
direciton  (in mm/sec). For 2D, #4 is thickness in mm. For 3D, #4 is velocity in z direction (in mm/sec).
(#5,#6) are one or more pairs where #5 is angle, conc, or temp and #6 is its value for the particles.</li>

<li>Sphere: Define spherical volume of material points or for a hole.</li>

</ul>

<h2><a name="feamesh"></a>Defining the FEA Mesh</h2>

<p>These commands are used to define the FEA Mesh.</p>

<ul>
<li><a name="area"></a><code>Area #1,#2,&lt;#3&gt;<br>
&nbsp;&nbsp;(list and/or define <a href="path">paths</a> and <a href="#keypoint">keypoints</a>)<br>
EndArea</code><br>
Define an area for mesh generation where #1 is a defined <a href="#material">material ID</a>,
#2 is thickness (in mm) (ignored in axisummetric FEA, but still required), and
#3 is an angle (for anisotropic materials) (it can be a <a href="#function">user-defined function</a>).
The commands in the area block should define four paths (to enclose 2D area) or
two paths (for a 1D interface). Material ID can be &quot;_NONE_&quot; when the
elements will be filled later by <a href="#bmpregionfea">BMPRegion</a> or various shape commands.</li>

<li><a name="bmpregionfea">BMPRegion</a> ... EndRegion: Generate elements from an image in a BMP file.</li>

<li><code>Element #1</code><br>
Define type of element to use in subsequent <a href="#area">Area</a> commands. #1 can be &quot;3 Node Triangle&quot; (or 1), &quot;4 Node Quadrilateral&quot; (or 2), &quot;8 Node Quadrilateral&quot; (or 3), 6 Node Triangle&quot; (or 4), &quot;4 Node Interface&quot; (or 5), 6 Node Interface&quot; (or 6), or &quot;9 Node Lagrange&quot; (or 8)</li>

<li><code>FlipTriangles &lt;#1&gt;</code><br>
Select the direction of trigular elements in meshes that use those elements. #1 is &quot;Yes&quot; or &quot;No&quot; to flip or omit to toggle current setting</li>

<li><a name="holefea"></a><code>Hole<br>
&nbsp;&nbsp;(series of <a href="#rectfea">Rect</a>, <a href="ovalfea">Oval</a>, or <a href="#polyptfea">PolyPt</a> commands)<br>
EndHole</code><br>
Define a region for creating a hole that removes elements in the mesh whose material
ID was set to &quot;_NONE_&quot;</li>

<li><a name="keypoint"></a><code>Keypoint #1,#2,#3,&lt;#4&gt;</code><br>
Define a keypoint used in defining <a name="path">Paths</a>. #1 is keypoint ID, #2, and #3 are x and y coordinates (or r and z if axisymmetric). Optional #4 can be &quot;polar&quot; to change #2 and #3 to be R and &theta; to define keypoint using polar coordinates relative to current <a href="#origin">origin</a>.</li>

<li><code>Keypoints  #1,#2,...</code><br>
Add multiple (and previously) defined keypoints to a <a href="#path">Path</a>.</li>

<li><a name="origin"></a><code>Origin #1,&lt;#2&gt;</code><br>
Define coordinate system origin for entry of <a href="#keypoint">Keypoints</a> using polar coordinates.
If only #1 is given is is keypoint ID; if #1 and #2 are both give they are (x,y) coordinates of the origin.</li>

<li><a name="ovalfea"></a><code>Oval #1,#2,#3,#4</code><br>
Define oval within the rectangle defined by xmin, xmax, ymin, ymax (for #1 to #4) for the current <a href="#regionfea">region</a> or <a href="#holefea">hole</a> block.</li>

<li><a nmame="path"></a><code>Path #1,#2,&lt;#3&gt;<br>
&nbsp;&nbsp;(list and/or define keypoinst along the path)<br>
EndPath</code><br>
Define a path used in defining <a href="#area">Areas</a>. #1 is the ID for the path. #2 is the number of intervals along the path when used in a mesh. Optional #3 defines the ratio of the first element size to the last element size. Alternatively, #3 can be negative to specify the absolute size of the first element (in mm) to be |#3|. #3 is 1 is not supplied. The commands between within the path block should list and/or define two or three keypoints for the path (two points for a line or three points for a curve.</li>

<li><code>Paths #1,#2,...</code><br>
Add multiple defined paths to an <a href="#area">Area</a>.</li>

<li><a name="polyptfea"></a><code>PolyPt &lt;#1:&gt;,&lt;#2&gt;</code><br>
Define next point on a polygon shape or if no paramters, close the current polygon shape. If a polygon is open and
the end of a <a href="#regionfea">region</a> or <a href="#holefea">hole</a> block, it
is automatically closed.</li>

<li><a name="rectfea"></a><code>Rect #1,#2,#3,#4</code><br>
Define rectangle using xmin, xmax, ymin, ymax (for #1 to #4) for the
current <a href="#regionfea">region</a> or <a href="#holempm">hole</a> block.</li>

<li><a name="regionfea"></a><code>Region #1,#2,&lt;#3:gt;<br>
&nbsp;&nbsp;(series of <a href="#rectfea">Rect</a>, <a href="rectfea">Oval</a>, or <a href="#polyptfea">PolyPt</a> commands)<br>
EndRegion</code><br>
Define a region for assigning material types to elements in the mesh whose
material ID was set to &quot;_NONE&quot;. #1 is a defined <a href="#material">material ID</a>,
#2 is thickness (in mm) (ignored in axisummetric FEA, but still required),
and #3 is an angle (for anisotropic materials)
(it can be a <a href="#function">user-defined function</a>).</li>

<li><code>Resequence #1,&lt;#2&gt;</code><br>
To turn on the option to resequence the nodes, which will minimize the bandwidth of
the problem and speed the calculations. If only key #1, it is a keypoint ID.
If #1 and #2 are give, the nodes are requenced from the node closest to those x and y coordinates.</li>

</ul>

<h2><a name="cracks"></a>Defining Explicit Cracks</h2>


<h3>Cracks in MPM Calculations</h3>

<p>Cracks in MPM calculations are implemented using the CRAMP algorithm first described by Nairn (developer of this software) and coworkers. The commands to define explicit cracks and set up crack
propagation in MPM calculations are:</p>

<ul>
<li>AltPropagate: Set a second rule for crack propagation and optional propagation direction for models with competing fracture modes.</li>
<li>ContactPosition: Determines method for detecting contact when using particle displacements.</li>
<li>CrackInterface: Sets custom interface parameters for a specific crack.</li>
<li>CrackThickness: Sets crack thickness; only used or needed when crack have traction laws or crack tips release their energy into heat.</li>
<li>Friction: Set crack contact conditions.</li>
<li><code>GrowCrack #1,#2,&lt;#3&gt;,&lt;#4&gt;</code><br>
Extend current crack to (#1,#2) in one segment. #3 can be crack tip material,
&quot;exterior&quot; (for crack
that extends beyond object), or invalid ID (no material). #4 is traction law material.</li>
<li>GrowCrackArc: Used to add a curved arc to the current crack.</li>
<li><code>GrowCrackLine #1,#2,#3,&lt;#4&gt;,&lt;#5&gt;</code><br>
Extend current crack to (#1,#2) along a line with #3 segments. #4 can be crack tip material,
&quot;exterior&quot; (for crack
that extends beyond object), or invalid ID (no material). #5 is traction law material.</li>
<li>GrowCrackArc: Used to add a curved arc to the current crack.</li>
<li><code>JContour #1,&lt;#2&gt;</code><br>
Used to set size of J integral contoour (#1 in cells) and whether J integral uses one
or two terms (#2 = 1 or 2).</li>
<li>ImperfectInterface: Converts cracks to imperfect interface and sets the interfacial properties.</li>
<li>MovePlane: Used to set how crack plane particles move.</li>
<li><code>NewCrack #1,#2,&lt;#3&gt;,&lt;#4&gt;,&lt;#5&gt;</code><br>
Start new crack at (#1,#2). #3 can be crack tip material, &quot;fixed&quot; (to be fixed crack),
&quot;exterior&quot; (for crack
that extends beyond object), or &quot;free&quot; (no material). #4 can be friction setting or
&quot;traction&quot;. If #4 is &quot;traction&quot;, #5 is traction law material.</li>
<li>Propagate: Set rule for crack propagation and optional propagation direction.</li>
<li>PropagateLength: Determines the amount of crack growth each time the crack propagates.</li>
<li><code>ToArchive #1,&lt;#2&gt;,...</code><br>
Specify crack parameters to be archived in MPM calculations. The list can be in multiple arguments and/or in multiple ToArchive commands. The archiving options for crack paramters are jintegral, stressintensity, and energybalance.</li>
</ul>


<h3>Cracks in FEA Calculations</h3>

<p>Crack in FEA calculations are set up by configuring the mesh to include a crack. A crack can be internal to the mesh or, for symmetric loading, can be on an edge of the mesh and defined with the help of boundary conditions. These two crack geometries are illustrated here:</p>
<center>
<img src = "ccfull.jpg" width = "190" height = "192" alt = "" align="top"/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<img src = "cchalf.jpg" width = "201" height = "228" alt = "" align="top"/>
</center>
<p>The crack plane edges must be collinear and of equal length (&Delta;a). When a calculation with cracks is done, the Crack Closure... command (in NairnFEAMPM) can be used to calculate crack tip energy release rate.</p>
<p>The one command to alter crack tip geometry is
</p>
<ul>
<li><code>CrackTip #1,&lt;#2&gt;</code><br>
Create quarter-point elements at the crack tip. Is one argument, #1 is a keypoint ID for the crack tip.
If two arguments the node closet to (#1,#2) (in mm) is the crack tip.</li>
</ul>

<h2><a name="mmmode"></a>Multimaterial MPM Calculations</h2>

<p>NairnMPM can use multimaterial mode where each material has its own velocity field
and intersections between materials on nodes are resolved using various contact
mechanics models. The key commands to use this mode are:</p>

<ul>
<li><code>ContactPosition #1</code><br>
Determines method for detecting contact when using particle displacements. Usually omitted
when all surfaces start
out in contact or 0.8 for moving into contact (default is omitted).</li>
<li><code>Friction #1,#2</code><br>
When this command is used within a <a href="#material">material</a>, it can set specific
material-material friction properties. #1 is same as for FrictionMM command and #2 is
material ID. Otherwise materials use the default settings from a FrictionMM 
or ImperfectInterfaceMM command.</li>
<li><code>FrictionMM #1</code><br>
Set default multimaterial mode friction properties. #1 is friction coefficient, &quot;stick&quot; for stick
contact, &quot;single&quot; (or &quot;ignore&quot;) to revert to single velocity field, or &quot;none&quot;
for frictionless (same as 0) (default 0).</li>
<li><code>Interface #1,#2,#3,#4</code><br>
When this command is used within a <a href="#material">material</a>, it can set specific
material-material imperfect interface properties. #1 to #3 are same as for ImperfectInterfaceMM
command (except that #3 is required) #4 is
material ID. Otherwise materials use the default settings from a FrictionMM
 or ImperfectInterfaceMM command.. </li>
<li><code>ImperfectInterfaceMM #1,#2,&lt;#3&gt;</code><br>
Set properties for contact to model an imperfect interface. #1 is Dt and #2 is #Dn for tangential and
normal interface parameters. If #3 is given, #2 is
Dnt and #3 is Dnc for normal interface parameters in tension an compression. All are in MPa/mm.</li>
<li><code>MultimaterialMode &lt;#1&gt;,&lt;#2&gt;,&lt;#3&gt;,&lt;#4&gt;</code><br>
Sets to use multimaterial modes and sets some options. #1 is minimum relative volume to allow contact (default 0.0).
#2 is &quot;enabled&quot; (or &quot;yes&quot; or 1) or &quot;disabled&quot; (or &quot;no&quot; or 0)
for detection of contact using particle displacements (default &quot;disabled&quot;). #3 is
&quot;maxgrad&quot; (or 0), &quot;maxvol&quot; (or 1), &quot;avggrad&quot; (or 2), or
quot;owngrad&quot; (or 3) to determine the method used to find surface normals during
contact calculations (default &quot;avggrad&quot;). #4 sets bias factor to use rigid normal when contact
is with rigid materials (default 1).</li>
</ul>


<h2><a name="thermal"></a>Thermal Calculations</h2>

<p>These commands are used to do thermal stress and thermal conductivity calculations</p>

<h3>MPM Thermal Calculations</h3>

<ul>
<li><code>Conduction #1,&lt;#2&gt;,...</code><br>
Turn on thermal conductivity calculations and define heat source options. #1 is yes or no. Additional
parameters are &quot;Adiabatic&quot;, &quot;Isothermal&quot; or &quot;Crack Tips&quot;.</li>

<li><code>GlobalArchive</code><br>
To archive average temperature, total heat energy, or total entropy.</li>

<li><code>HeatFlux external,#1,#2,#3,&lt;#4&gt;</code><br>
Apply heat flux to selected particles on face #1 with style #2 and
arguments in #3 and #4.</li>

<li>Intensity: To set initial temperature of particles created using
a <a name="#bmpregion">BMPRegion</a>.</li>

<li><code>Material #1,#2,#3</code><br>
Use the <a href="#material">material</a> command to define material
properties needed for conduction calculations (conductivity, heat capactiy,
coefficient of thermal expansion, <i>etc.</i>).</li>

<li><code>StressFreeTemp #1</code><br>
Set the stress free temperature to #1.</li>

<li><code>Temperature #1,#2,&lt;#3:gt;</code><br>
Apply temperature boundary conditions to selected nodes. The style is #1 and arguments in #2 and #3.
</li>

<li><code>ThermalRamp #1,&lt;#2&gt;</code><br>
Apply isothermal temperature difference of #1 over a specified time (#2 in ms).</li>

<li><code>RampStart #1</code><br>
Set the start time (#1 in ms) for application of a thermal ramp.</li>

<li><code>Region ... EndRegion</code><br>
To set initial particle temperature when <a href="#regionmpm">creating material points</a>.</li>

<li><code>ToArchive #1,&lt;#2&gt;,...</code><br>
Specify results to be archived in MPM calculations. The list can be in multiple arguments
and/or in multiple ToArchive commands. The archiving options related to thermal
calculations are temperature and heatenergy.</li>
</ul>

<h3>FEA Thermal Calculations</h3>

<ul>
<li><code>Material #1,#2,#3</code><br>
Usse the <a href="#material">material</a> command methods to define material properties
needed for thermal calculations (coefficient of thermal expansion).</li>

<li><code>StressFreeTemp #1</code><br>
Set the stress free temperature; the default is zero.</li>

<li><code>Temperature #1</code><br>
Apply temperature to all nodes. Enter a <a href="function">user defined function</a>
of nodal position (x and y).
It is only the difference between temperature and stress free temperature that matters.
</li>

</ul>

<h2><a name="conc"></a>Diffusion Calculations</h2>

<p>These commands are used to do diffusion calculations (MPM only):</p>

<ul>
<li><code>Concentration #1,#2,&lt;#3:gt;</code><br>
Apply concentration conditions to selected nodes. The style is #1 and arguments in #2 and #3.
</li>

<li><code>ConcentrationFlux external,#1,#2,#3,&lt;#4&gt;</code><br>
Apply concentratation flux to selected particles on face #1 with style #2 and
arguments in #3 and #4.</li>

<li><code>Diffusion #1,&lt;#2&gt;</code><br>
To turn on diffusion calculations. #1 is yes or no to activate diffusion. #2 can specify
a reference concentration between 0 and 1 (default is 0).</li>

<li><code>GlobalArchive</code><br>
To archive total weight fracture concentration.</li>

<li>Intensity: To set initial concentration of particles created using a
<a name="#bmpregion">BMPRegion</a>.</li>

<li><code>Material #1,#2,#3</code><br>
Use the <a href="#material">material</a> command to define material properties needed
for diffusion calculations (diffusion constant, saturation concentration, coefficient
of concentration expansion, <i>etc.</i>).</li>

<li><code>Region ... EndRegion</code><br>
To set initial particle concentration when <a href="#regionmpm">creating material points</a>.</li>

<li><code>ToArchive #1,&lt;#2&gt;,...</code><br>
Specify results to be archived in MPM calculations. The list can be in multiple
arguments and/or in multiple ToArchive commands. The archiving option related to
diffusion calculations is concentration (which includes concentration gradients).</li>

</ul>

<h2><a name="bconds"></a>Applying Boundary Conditions</h2>

<p>These commands are used to apply boundary conditions to the particles or to the grid.</p>

<h3>MPM Boundary Conditions</h3>

<ul>

<li><code>BoundaryID &lt;#1&gt;</code><br>
Set ID for velocity boundary condition for use when global archiving reaction forces. #1
should be negative. If omitted it is set to 0 (which means ID is not set).</li>

<li><code>Concentration #1,#2,&lt;#3:gt;</code><br>
Apply concentration conditions to selected nodes. The style is #1 and arguments in #2 and #3.
</li>

<li><code>ConcentrationFlux external,#1,#2,#3,&lt;#4&gt;</code><br>
Apply concentratation flux to selected particles on face #1 with style #2 and
arguments in #3 and #4.</li>

<li><code>Gravity &lt;#1&gt;,&lt;#2&gt;,&lt;#3&gt;</code><br>
Apply body forces to all particles for simulations within a constant graviational field
where #1, #2, and #3 are the accelerations due to gravity (in m/sec<sup>2</sup>) in the x, y, and z
directions, respectively (#1 and #2 are for R and Z directions in axisymmetric calculations). If all
are omitted, this commands activates gravity with setting (0,-9.8,0). If command is not used,
there is no gravity.</li>

<li><code>HeatFlux external,#1,#2,#3,&lt;#4&gt;</code><br>
Apply heat flux to selected particles on face #1 with style #2 and
arguments in #3 and #4.</li>

<li><code>Load #1,#2,#3,&lt;#4&gt;</code><br>
Apply force to selected particles in direction #1 with style #2 and arguments in #3 and #4.</li>

<li>LoadArc ... EndLoadArc: Apply force or concentration flux conditions to particles near an arc.</li>

<li>LoadBox ... EndLoadBox: Apply force or concentration flux conditions to particles within a 3D box.</li>

<li><code>LoadLine #1,#2,#3,#4,&lt;#5&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
EndLoadLine</code><br>
Apply force or flux conditions to particles near a line from (#1,#2) to (#3,#4) with tolerance
#5.</li>

<li>LoadRect ... EndLoadRect: Apply force or concentration flux conditions to particles within a rectangle.</li>

<li><code>MoveArc #1,#2,#3,#4,#5,#6,&lt;#7&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
EndMoveArc</code><br>
Apply velocity, temperature, or concentration conditions to nodes along an inside oval with corners at
(#1,#2) and (#3,#4) draw between angles #5 and #6 (in dergrees) with optional tolerance #5.</li>

<li><code>MoveBox #1,#2,#3,#4,#5,#6,&lt;#7;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
EndMoveBox</code><br>
Apply velocity, temperature, or concentration conditions to nodes within a 3D box with corners
(#1,#2,#3) and (#4,#5,#6). If #7 is used it mut be x, y, or z (or 1, 2, or 3) and will convert
box to cylinder with axis along the specified direction.</li>

<li><code>MoveLine #1,#2,#3,#4,&lt;#5&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
EndMoveLine</code><br>
Apply velocity, temperature, or concentration conditions to nodes along a line from (#1,#2) to
(#3,#4) with optional tolerance #5.</li>

<li><code>Temperature #1,#2,&lt;#3:gt;</code><br>
Apply temperature boundary conditions to selected nodes. The style is #1 and arguments in #2 and #3.
</li>

<li><code>Traction #1,#2,#3,#4,&lt;#5&gt;</code><br>
Apply traction to selected particles in direction #1 on face #2 with style #3 and
arguments in #4 and #5.</li>

<li><code>Velocity #1,#2,&lt;#3&gt;,&lt;#4&gt;,&lt;#5&gt;,&lt;#6&gt;</code><br>
Apply velocity conditions to currently selected nodes. #1 is direction (x, t, z, skewxy, skewxz,
skewyz, skewxyz, or skewrz).
#2 is style with #3 and #4 optional arguments. If #1 is skewxy, skewxz, skewyz, or skewrz, #5 is skew angle.
If #1 is skewxyz, #6 is second angle</li>
</ul>

<h3>FEA Boundary Conditions</h3>

<ul>

<li><a name="displacement"></a><code>Displacement #1,&lt;#2&gt;</code><br>
Apply displacement conditions to <a href="#fixline">selected nodes</a>. #1 is x or y (or 1 or 2) to
specify the direction of the applied displacement (they can R or Z for axisymmetric FEA).
#2 specfies magnitude of the displacement in mm.
It can be specified by a number or by a <a href="#function">user-defined function</a> of nodal point position,
entered as quoted text. If #2 is omitted, the default displacement is 0 (<i>i.e.</i>, a fixed node).</li>

<li><a name="fixline"></a><code>FixLine #1,&lt;#2&gt;,&lt;#3&gt;,&lt;#4&gt;,&lt;#5&gt;<br>
&nbsp;&nbsp;(any number or <a href="#displacement">Displacement</a>, <a href="#load">Load</a>, or <a href="#rotate">Rotate</a> commands)<br>
&nbsp;&nbsp;(any number of <a href="#stress">Stress</a> commands when fixing a path)<br>
&nbsp;&nbsp;(one optional <a href="#select">Select</a> command)<br>
EndFixLine</code><br>
Apply displacement or load conditions to nodes along a line. If only #1 is given, it must be a <a href="#path">path ID</a>. If #1 through #5 are given, #1 to #4 give (x1,y1) and (x2,y2). All nodes along that line ar assigned boundary conditions. The optional #5 is a tolerance to select nodes within that distance from the line.</li>

<li><a name="fixpoint"></a><code>FixPoint #1,&lt;#2&gt;<br>
&nbsp;&nbsp;(any number or <a href="#displacement">Displacement</a>, <a href="#load">Load</a>, or <a href="#rotate">Rotate</a> commands)<br>
&nbsp;&nbsp;(one optional <a href="#select">Select</a> command)<br>
EndFixPoint</code><br>
Apply displacement or load conditions to a single node. If only #1 is given, it must be a <a href="#keypoint">keypoint ID</a> and boundary conditions are applied to that node. If #1 and #2 are given, they define coordinates (in mm) for a point and the boundary conditions will be applied to the one node nearest to that point.</li>

<li><a name="load"></a><code>Load #1,#2</code><br>
Apply forces to selected nodes. #1 is x or y (or 1, or 2, R, or Z if axisymmetric) to specify the direction of the applied force. #2 is the applied force (in N). It can be specified by a number or by a <a href="#function">user-defined function</a> of nodal point position.</li>

<li><code>Periodic #1,&lt;#2&gt;,&lt;#3&gt;,&lt;#4&gt;</code><br>
Set up calculations to be periodic where #1 is the direction (x, y, or Z), #2 and #4 are 
Delta or Slope (or Shear) and the corresponding #3 and #5 are their settings.</li>

<li><a name="rotate"></a><code>Rotate #1,#2</code><br>
Rotate selected nodes for the purpose of applying skewed displacement boundary conditions.
#1 must be z (or 3). #2 is the clockwise angle.</li>

<li><a name="select"></a><code>Select</code><br>
Select the nodes and/or elements reference by the current <a href="#fixline">FixLine</a> or <a href="#fixpoint">FixPoint</a> boundary condition for conditional <a href="#output">output</a> of results.</li>

<li><a name="selectline"></a><code>SelectLine #1,&lt;#2&gt;,&lt;#3&gt;,&lt;#4&gt;,&lt;#5&gt;</code><br>
Select all nodes on a line for conditional <a href="#output">output</a> of results. If only #1 is given, it must be a <a href="#path">path ID</a>. If #1 through #5 are given, #1 to #4 give (x1,y1) and (x2,y2). All nodes along that line are selected. The optional #5 is a tolerance to select nodes within that distance from the line.</li>

<li><a name="selectpoint"></a><code>SelectPoint #1,&lt;#2&gt;</code><br>
Select one node for conditional <a href="#output">output</a> of results. If only #1 is given, it must be a <a href="#keypoint">keypoint ID</a> that node is selected. If #1 and #2 are given, they define coordinates (in mm) and the node closest to that point is selected.</li>

<li><a name="stress"></a><code>Stress #1,#2,&lt;#3&gt;,&lt;#4&gt;</code><br>
Apply stress boundary conditions to faces of <a href="#fixline">selected elements</a> which must be selected using a <a href="#path">path ID</a>. #1 is &quot;n&quot; (or 1) or &quot;t&quot; (or 2) for stress to be normal to the edge or tangential; the later is positive when loading the element face in the counter-clockwise direction. #2,&lt;#3&gt;,&lt;#4&gt; are 1 to 3 stresses. Give one stress for constant stress, two stresss for linear variation in stress along the edge, or three stresses for a quadratic variation in stress.</li>

</ul>

<h2><a name="custom"></a>Custom Tasks</h2>

<p>These commands are used to schedule custom tasks that are run at the end of each time step in MPM calculations.</p>

<ul>
<li>CustomTask: Schedule a custom task and documentation on all possible custom tasks.
</li>

<li>Parameter: set a parameter for the current custom task.
</li>

</ul>

<h2><a name="xml"></a>XML Commands</h2>

<p>These commands are used to insert raw <code>XML</code> commands at various locations in the input commands. See Code Engine Commands for the format of all raw <code>XML</code> commands.</p>

<ul>

<li><code>Entity #1,#2</code><br>
Define entity to appear in XML output file. #1 is enity without ampersand and semicolor and #2 is
its value.</li>

<li><a name="xmldata"></a><code>XMLData &lt;#1&gt;,&lt;#2&gt;<br>
&nbsp;&nbsp;(lines of verbatim XML content)<br>
EndXMLData</code><br>
Insert XML data in the interpretation output. #1 indicates the section where the XML content will be inserted and it will be at the end of that section. If #1 is omitted, the XML content is inserted at the end. The section can be any top level section defined for input files (and is case sensitive). If #1 is &quot;Material&quot;, the XML content is assumed to completely define a single material. This content is inserted (in definition order) among other materials and #2 must define the <a href="#material">material ID</a>,. which can be referenced in other commands.</li>

</ul>

<h2><a name="function"></a>User-Defined Functions</h2>

<p>Details to follows.</p>


</body>

</html>